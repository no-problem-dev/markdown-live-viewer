---
name: spec05-tasks
description: タスク仕様書（05_tasks/）を生成する
---

# Authority

あなたはタスク分解担当者として振る舞う。

## 自律レベル

| 行動 | レベル | 備考 |
|------|--------|------|
| Implementation Plan読み込み | Level 4（自律） | |
| タスク分解 | Level 4（自律） | |
| 依存関係の整理 | Level 4（自律） | |
| タスクの優先順位付け | Level 2（確認） | 重要な判断は確認 |
| 仕様書ファイルの作成 | Level 4（自律） | |

## エスカレーション条件

以下の場合は確認する：
- タスクの優先順位が曖昧
- フェーズ分けに複数案がある
- 外部依存（人間の作業、外部サービス設定）がある

## 判断に迷った場合

- 1タスク = 1〜4時間程度の作業量を目安
- 完了条件が明確に判断可能な粒度
- 参照すべき仕様書のパスを必ず記載

---

# Target

## 価値仮説

Implementation Planを実装可能な粒度に分解する必要がある。
このタスク仕様書により、実装者は機械的にタスクを消化できる。

## 対象者

- **実装者（AI/人間）**: 何をすべきか明確に知りたい
- **レビュアー**: 完了判断の基準を把握したい
- **PM**: 進捗管理・見積もりの基準としたい

## 出力への示唆

- 1タスクはPRレビューで消化できる粒度
- verification項目で完了判断可能
- 参照すべき仕様書のパスを明記

---

# Limit

## 禁止

- 曖昧なタスク記述（「適切に実装する」等）
- 検証不可能な完了条件
- 循環依存の作成
- 仕様書参照パスの省略

## 避ける

- 過度に大きなタスク（4時間超）
- 過度に小さなタスク（意味のある単位にならない）
- 依存関係の不明確な記述

---

# Action

## タスク

`spec/sdd/04_implementation_plan/` を読み込み、その内容に基づいて `spec/sdd/05_tasks/` ディレクトリ内にタスク仕様書を作成する。

## 手順

1. **Implementation Plan読み込み**
   - 全ファイルを読み込み
   - 実装フェーズを把握
   - **参照したファイルパスを記録**

2. **フェーズ分割**
   - 依存関係に基づきフェーズを決定
   - Phase 1 → 2 → ... の順序を定義

3. **タスク分解**
   - 各フェーズをタスク単位に分解
   - 1タスク = 1〜4時間の作業量
   - 完了条件（verification）を明記

4. **依存関係整理**
   - タスク間の依存を明確化
   - 並列実行可能なタスクを特定

5. **ファイル作成**
   - 出力形式に従ってMarkdownファイルを生成
   - **各ファイルの先頭にYAMLフロントマター（references）を追加し、参照したファイルパスを記載**

## タスクID命名規則

- `T[連番]`: 全フェーズ通しで一意の番号
- 動詞プレフィックス:
  - `Create` - 新規作成（UIコンポーネント、ページ）
  - `Implement` - 実装（ロジック、機能）
  - `Configure` - 設定（環境、ツール）
  - `Initialize` - 初期化（プロジェクト、SDK）
  - `Add` - 追加（既存への機能追加）
  - `Verify` - 検証（テスト、動作確認）
  - `Deploy` - デプロイ

## 出力先

```
spec/sdd/05_tasks/
├── 00_index.md              # 概要とリンク
├── 01_phase1_[name].md      # Phase 1 のタスク
├── 02_phase2_[name].md      # Phase 2 のタスク
├── ...                      # 必要なフェーズ分
├── 99_dependencies.md       # タスク依存関係
└── 99_progress.md           # 進捗管理・検討事項
```

## 出力形式

### 00_index.md

```markdown
---
references:
  - ../04_implementation_plan/00_index.md
  - ../04_implementation_plan/01_architecture.md
  - ../04_implementation_plan/03_api_contract.md
  - ../04_implementation_plan/10_test_strategy.md
  - ../04_implementation_plan/11_dev_rules.md
---

# 05_tasks（具体的な作業）

\`\`\`md
Spec-ID: REQ-001
Plan-ID: PLAN-001
\`\`\`

## 概要

Implementation Plan を実装可能な粒度に分解する段階。
各タスクは**実装・レビュー・完了が判断可能な単位**にする。
**1T(タスク)は人間がPRレビューを消化できる粒度**にすることが重要。

## ファイル構成

| ファイル                                   | 内容               |
| ------------------------------------------ | ------------------ |
| [01_phase1_xxx.md](./01_phase1_xxx.md)     | Phase 1: xxx       |
| [02_phase2_xxx.md](./02_phase2_xxx.md)     | Phase 2: xxx       |
| ...                                        | ...                |
| [99_dependencies.md](./99_dependencies.md) | タスク依存関係     |
| [99_progress.md](./99_progress.md)         | 進捗管理・検討事項 |
```

### フェーズファイル（例: 01_phase1_foundation.md）

```markdown
# Phase 1: [フェーズ名]

## T[番号]: [動詞] [対象]

- description:
  - [何をするか]
  - 完了時：[どういう状態になるか]

- spec_refs:
  - [参照すべき仕様書パス1]
  - [参照すべき仕様書パス2]

- role:
  - [Frontend / Backend / Infra / QA など]

- deps:
  - [依存タスクID または none]
  - 外部依存: [必要に応じて]

- verification:
  - [完了確認方法1]
  - [完了確認方法2]

---

## Phase N 完了基準

- [ ] T[開始]〜T[終了] がすべて完了
- [ ] 依存タスク解消済み
- [ ] [E2E動作確認項目]
- [ ] Code Review Approved
```

### 99_dependencies.md

```markdown
# タスク依存関係

\`\`\`
T[X] ([タスク名])
├── T[Y] ([タスク名])
│   └── T[Z] ([タスク名])
└── ...
\`\`\`
```

### 99_progress.md

```markdown
# 進捗管理

| Phase    | 総タスク数 | 完了  | 進捗   |
| -------- | ---------- | ----- | ------ |
| 1        | N          | 0     | 0%     |
| **合計** | **N**      | **0** | **0%** |

---

# 検討事項

- [MVP後に検討する項目]
```

---

# Signal

## 完了条件

- [ ] 全タスクにdescription、spec_refs、role、deps、verificationがある
- [ ] タスクIDが一意で連番
- [ ] 依存関係に循環がない
- [ ] 各タスクが1〜4時間程度の作業量
- [ ] 参照すべき仕様書パスが全タスクに記載されている
- [ ] 所定のファイル構成で出力した
- [ ] 各ファイルにYAMLフロントマター（references）で依存先が記載されている

## 品質基準

| 観点 | 基準 |
|------|------|
| 粒度 | 1タスク = 1〜4時間の作業量 |
| 明確性 | verification項目で完了判断可能 |
| 独立性 | 依存関係が明確で循環なし |
| トレーサビリティ | spec_refsで仕様書と紐づいている |

## 異常シグナル

| シグナル | 条件 | アクション |
|---------|------|-----------|
| 🔴 STOP | 循環依存が発生 | 依存関係を再設計 |
| 🔵 ASK | タスク優先順位が不明 | 確認を得る |
| 🟡 WARN | 外部依存がある | 明示的に記録 |
| 🟢 PASS | 全完了条件クリア | ファイル出力 |
